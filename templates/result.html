<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>
      {% if lang == 'hindi' %}рд╕реНрдХреИрди рдкрд░рд┐рдгрд╛рдо - рдЖрдпреБрд╖рд╕реНрдХреИрди{% else %}Scan Results -
      AyushScan{% endif %}
    </title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/static/styles/result.css" />
  </head>
  <body>
    <h2>
      ЁЯз╛ {% if lang == 'hindi' %}рд╕реНрдХреИрди рдкрд░рд┐рдгрд╛рдо{% else %}Scan Results{% endif %}
    </h2>

    <table id="resultsTable">
      <thead>
        <tr>
          <th>{% if lang == 'hindi' %}рдЖрдЗрдЯрдо{% else %}Item{% endif %}</th>
          <th>
            {% if lang == 'hindi' %}рдЕрдиреБрдорд╛рдирд┐рдд рдПрдордЖрд░рдкреА{% else %}Expected MRP{%
            endif %}
          </th>
          <th>
            {% if lang == 'hindi' %}рдмрд┐рд▓ рд░рд╛рд╢рд┐{% else %}Billed Amount{% endif %}
          </th>
          <th>{% if lang == 'hindi' %}рд╕реНрдерд┐рддрд┐{% else %}Status{% endif %}</th>
        </tr>
      </thead>
      <tbody id="resultsBody">
        <!-- Filled by JS -->
      </tbody>
    </table>

    <!-- New Section: Detected Illness -->
    {% if illness %}
    <div class="illness-section">
      <h3>
        {% if lang == 'hindi' %}ЁЯза рдкрд╣рдЪрд╛рдиреА рдЧрдИ рдмреАрдорд╛рд░реА:{% else %}ЁЯза Detected
        Illness:{% endif %}
      </h3>
      <p>{{ illness }}</p>
    </div>
    {% endif %}

    <!-- New Section: Ayushman Bharat Eligibility -->
    {% if scheme_info %}
    <div class="scheme-section">
      <h3>
        {% if lang == 'hindi' %}ЁЯПе рдЖрдпреБрд╖реНрдорд╛рди рднрд╛рд░рдд рдпреЛрдЬрдирд╛:{% else %}ЁЯПе Ayushman
        Bharat Scheme:{% endif %}
      </h3>
      <p>{{ covered }}</p>
    </div>
    {% endif %}

    <a href="/dashboard" class="btn-back">
      тмЕя╕П {% if lang == 'hindi' %}рдбреИрд╢рдмреЛрд░реНрдб рдкрд░ рд╡рд╛рдкрд╕ рдЬрд╛рдПрдБ{% else %}Back to
      Dashboard{% endif %}
    </a>

    <script>
      const lang = "{{ lang }}";
      const data = JSON.parse(localStorage.getItem("scanResults"));
      const flagged = data.flagged || {};
      const tbody = document.getElementById("resultsBody");

      if (Object.keys(flagged).length === 0) {
        const row = document.createElement("tr");
        const message =
          lang === "hindi"
            ? "тЬЕ рдУрд╡рд░рдмрд┐рд▓рд┐рдВрдЧ рдирд╣реАрдВ рдкрд╛рдИ рдЧрдИред"
            : "тЬЕ No overbilling detected.";
        row.innerHTML = `<td colspan="4" class="no-data">${message}</td>`;
        tbody.appendChild(row);
      } else {
        for (const item in flagged) {
          const f = flagged[item];
          const statusText =
            lang === "hindi"
              ? `ЁЯЪи тВ╣${f.extra} рдХреА рдЕрддрд┐рд░рд┐рдХреНрдд рдмрд┐рд▓рд┐рдВрдЧ`
              : `ЁЯЪи Overbilled by тВ╣${f.extra}`;
          const row = document.createElement("tr");
          row.classList.add("overbilled");
          row.innerHTML = `
          <td>${item.toUpperCase()}</td>
          <td>тВ╣${f.expected}</td>
          <td>тВ╣${f.billed}</td>
          <td>${statusText}</td>
        `;
          tbody.appendChild(row);
        }
      }
    </script>
  </body>
</html>
