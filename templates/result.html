<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>
      {% if lang == 'hindi' %}‡§∏‡•ç‡§ï‡•à‡§® ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ - ‡§Ü‡§Ø‡•Å‡§∑‡§∏‡•ç‡§ï‡•à‡§®{% else %}Scan Results -
      AyushScan{% endif %}
    </title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/static/styles/result.css" />
  </head>
  <body>
    <h2>
      üßæ {% if lang == 'hindi' %}‡§∏‡•ç‡§ï‡•à‡§® ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ{% else %}Scan Results{% endif %}
    </h2>

    <table id="resultsTable">
      <thead>
        <tr>
          <th>{% if lang == 'hindi' %}‡§Ü‡§á‡§ü‡§Æ{% else %}Item{% endif %}</th>
          <th>
            {% if lang == 'hindi' %}‡§Ö‡§®‡•Å‡§Æ‡§æ‡§®‡§ø‡§§ ‡§è‡§Æ‡§Ü‡§∞‡§™‡•Ä{% else %}Expected MRP{%
            endif %}
          </th>
          <th>
            {% if lang == 'hindi' %}‡§¨‡§ø‡§≤ ‡§∞‡§æ‡§∂‡§ø{% else %}Billed Amount{% endif %}
          </th>
          <th>{% if lang == 'hindi' %}‡§∏‡•ç‡§•‡§ø‡§§‡§ø{% else %}Status{% endif %}</th>
        </tr>
      </thead>
      <tbody id="resultsBody">
        <!-- Filled by JS -->
      </tbody>
    </table>

    <a href="/dashboard" class="btn-back">
      ‚¨ÖÔ∏è {% if lang == 'hindi' %}‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§™‡§∞ ‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Å{% else %}Back to
      Dashboard{% endif %}
    </a>

    <script>
      const lang = "{{ lang }}";
      const data = JSON.parse(localStorage.getItem("scanResults"));
      const flagged = data.flagged || {};
      const tbody = document.getElementById("resultsBody");

      if (Object.keys(flagged).length === 0) {
        const row = document.createElement("tr");
        const message =
          lang === "hindi"
            ? "‚úÖ ‡§ì‡§µ‡§∞‡§¨‡§ø‡§≤‡§ø‡§Ç‡§ó ‡§®‡§π‡•Ä‡§Ç ‡§™‡§æ‡§à ‡§ó‡§à‡•§"
            : "‚úÖ No overbilling detected.";
        row.innerHTML = `<td colspan="4" class="no-data">${message}</td>`;
        tbody.appendChild(row);
      } else {
        for (const item in flagged) {
          const f = flagged[item];
          const statusText =
            lang === "hindi"
              ? `üö® ‚Çπ${f.extra} ‡§ï‡•Ä ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§¨‡§ø‡§≤‡§ø‡§Ç‡§ó`
              : `üö® Overbilled by ‚Çπ${f.extra}`;
          const row = document.createElement("tr");
          row.classList.add("overbilled");
          row.innerHTML = `
            <td>${item.toUpperCase()}</td>
            <td>‚Çπ${f.expected}</td>
            <td>‚Çπ${f.billed}</td>
            <td>${statusText}</td>
          `;
          tbody.appendChild(row);
        }
      }
    </script>
  </body>
</html>
